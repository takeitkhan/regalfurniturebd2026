# ModSecurity rules for blocking unwanted registrations
# Add this file to your ModSecurity include path (e.g. modsecurity.conf)
# Example: Include /etc/modsecurity/registration-block.conf

# Block specific IPs (replace with real IPs)
# SecRule REMOTE_ADDR "@(ipMatch 203.0.113.10,198.51.100.22)" "id:120001,phase:1,deny,status:403,log,msg:'Blocked IP (registration abuse)'")

# Block specific ASNs (requires GeoIP2 + ModSecurity with GEO:ASN)
# Replace 13335, 16509 with actual ASN numbers
# SecRule GEO:ASN "@(pm 13335 16509)" "id:120002,phase:1,deny,status:403,log,msg:'Blocked ASN (registration abuse)')"

# Block registration endpoints for known bad IPs (example, add IPs above)
# Web registration
SecRule REQUEST_URI "@beginsWith /register" "id:120010,phase:1,pass,log,msg:'Registration endpoint hit'"
# API registration
SecRule REQUEST_URI "@beginsWith /api/register" "id:120011,phase:1,pass,log,msg:'API register endpoint hit'"

# If you want to deny all registration temporarily, uncomment:
# SecRule REQUEST_URI "@beginsWith /register" "id:120012,phase:1,deny,status:403,log,msg:'Registration temporarily disabled'"
# SecRule REQUEST_URI "@beginsWith /api/register" "id:120013,phase:1,deny,status:403,log,msg:'API registration temporarily disabled'"
